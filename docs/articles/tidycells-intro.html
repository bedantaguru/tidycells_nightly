<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tidycells Package • tidycells</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tidycells Package">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidycells</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/FileTypes.html">Supported File Types</a>
    </li>
    <li>
      <a href="../articles/tidycells-intro.html">Tidycells Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-rudra/tidycells">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tidycells Package</h1>
                        <h4 class="author">Indranil Gayen</h4>
            
            <h4 class="date">2019-10-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-rudra/tidycells/blob/master/vignettes/tidycells-intro.Rmd"><code>vignettes/tidycells-intro.Rmd</code></a></small>
      <div class="hidden name"><code>tidycells-intro.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify}
</style>
<p><img src="ext/logo.svg" align="right" width="150" style="border: 0;"></p>
<div id="tidycells" class="section level1">
<h1 class="hasAnchor">
<a href="#tidycells" class="anchor"></a><strong>tidycells</strong>
</h1>
<div id="read-tabular-data-from-diverse-sources-and-easily-make-them-tidy" class="section level4">
<h4 class="hasAnchor">
<a href="#read-tabular-data-from-diverse-sources-and-easily-make-them-tidy" class="anchor"></a><em>Read Tabular Data from Diverse Sources and Easily Make Them Tidy</em>
</h4>
</div>
<div id="tldr" class="section level2">
<h2 class="hasAnchor">
<a href="#tldr" class="anchor"></a>TL;DR</h2>
<p>Given a <code>file_name</code> which is a path of a file that contains table(s). Run this <code><a href="../reference/read_cells.html">read_cells()</a></code> in the R-console to see whether support is present for the file type. If support is present, just run</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>(file_name)</a></code></pre></div>
<p><strong>Note</strong> Just start with a small file.</p>
</div>
<div id="inspiration" class="section level2">
<h2 class="hasAnchor">
<a href="#inspiration" class="anchor"></a>Inspiration</h2>
<p>A spreadsheet is really flexible in storing and sharing data. Many organizations use excel files as their fundamental medium of data exchange (particularly in the government sector). These data are generally not in tidy format (thanks to ultra flexibility of spreadsheets!).</p>
<p>This is a great time killer for R data scientist adopting <a href="https://www.tidyverse.org/">tidyverse</a> techniques. A lot of time is spent to bring the data into a consumable or usable format (<a href="https://r4ds.had.co.nz/tidy-data.html">tidy format</a>).</p>
<p>For example, you may check out <a href="https://dbie.rbi.org.in/">Database of Indian Economy</a> (a public data dissemination platform from <a href="https://www.rbi.org.in/"><em>Reserve Bank of India</em></a>). This platform is a great source of Indian economy data. However, since the target audience of this platform is possibly common people and not data scientists, the data structure is not suitable for ready consumption in <em>tidyverse</em> functions. This is not only one, but there are plenty of great source of data which provides data in <em>“eye-relaxing”</em> format rather than tidy format.</p>
<p>Thanks to great packages like <a href="https://github.com/tidyverse/tidyr">tidyr</a>, <a href="https://github.com/nacnudus/tidyxl">tidyxl</a>, <a href="https://github.com/nacnudus/unpivotr">unpivotr</a> (and many other sweet packages mentioned in <em>reference</em>) which enable users to spend less time in reshaping the data and focus more on analysis rather than data wrangling.</p>
<p>These packages require user interaction and decision to transform and reshape the raw data (which is still easier than doing <em>copy-paste and transpose</em> in excel) into the tidy format.</p>
<p>However, consider the situations like, you are given a pile of excel (or any other format of spreadsheets) which are somehow similar but are generated by various human hands over a long period (obviously the format and structure will change from file to file). Or you want to build an automated forecast mechanism based on some spreadsheet which updates periodically (possibly you may get the updated file through some automated channel like web scraping, FTP transfer etc.). Or simply you want something like <em>“I’m Feeling Lucky!”</em></p>
</div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The package provides utilities to read, cells from complex tabular data and heuristic detection based ‘structural assignment’ of those cells to a columnar or tidy format.</p>
<p>Read functionality has the ability to read (in a unified manner) structured, partially structured or unstructured tabular data (usually spreadsheets for public data dissemination and aimed for common human understanding) from various types of documents. The tabular information is read as cells. The ‘structure assignment’ functionality has both supervised and unsupervised way of assigning cells data to columnar/tidy format. Multiple disconnected blocks of tables in a single sheet are also handled appropriately.</p>
<p>These tools are suitable for unattended conversation of (maybe a pile of) messy tables (like government data) into a consumable format(usable for further analysis and data wrangling).</p>
</div>
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting Started</h2>
<div id="reading-data" class="section level3">
<h3 class="hasAnchor">
<a href="#reading-data" class="anchor"></a>1. Reading Data</h3>
<p>Assuming you have a document(in either csv, xls, xlsx, docx, doc, html or in pdf, <em>well not a scanned one</em>) which contains a table, you can read the file directly to a tidy format (let’s refer the same as composed format) using <code>read_cells</code> like the following example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">fold &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"messy"</span>, <span class="dt">package =</span> <span class="st">"tidycells"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co"># this is because extension is intentionally given wrong  </span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co"># while filename is actual identifier of the file type</span></a>
<a class="sourceLine" id="cb2-4" title="4">fcsv &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(fold, <span class="dt">pattern =</span> <span class="st">"^csv."</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span>]</a></code></pre></div>
<p>Let’s see how the file actually looks like</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">utils<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(fcsv)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Kid.Name</th>
<th align="left">Weight</th>
<th align="left">Age</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Nakshatra</td>
<td align="left">12</td>
<td align="left">1.5</td>
</tr>
<tr class="even">
<td align="left">Titas</td>
<td align="left">16</td>
<td align="left">6.0</td>
</tr>
</tbody>
</table>
<p>Now we can simply run</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>(fcsv)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">collated_1</th>
<th align="left">collated_2</th>
<th align="left">collated_3</th>
<th align="left">table_tag</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Weight</td>
<td align="left">Nakshatra</td>
<td align="left">Kid Name</td>
<td align="left">Table_1</td>
<td align="left">12</td>
</tr>
<tr class="even">
<td align="left">Weight</td>
<td align="left">Titas</td>
<td align="left">Kid Name</td>
<td align="left">Table_1</td>
<td align="left">16</td>
</tr>
<tr class="odd">
<td align="left">Age</td>
<td align="left">Nakshatra</td>
<td align="left">Kid Name</td>
<td align="left">Table_1</td>
<td align="left">1.5</td>
</tr>
<tr class="even">
<td align="left">Age</td>
<td align="left">Titas</td>
<td align="left">Kid Name</td>
<td align="left">Table_1</td>
<td align="left">6</td>
</tr>
</tbody>
</table>
<p>Not a big deal for csv though. Also looks similar to</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(fcsv) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/tidyr/man/gather.html">gather</a></span>(measure, val_of_measure, <span class="op">-</span>Kid.Name)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Kid.Name</th>
<th align="left">measure</th>
<th align="left">val_of_measure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Nakshatra</td>
<td align="left">Weight</td>
<td align="left">12.0</td>
</tr>
<tr class="even">
<td align="left">Titas</td>
<td align="left">Weight</td>
<td align="left">16.0</td>
</tr>
<tr class="odd">
<td align="left">Nakshatra</td>
<td align="left">Age</td>
<td align="left">1.5</td>
</tr>
<tr class="even">
<td align="left">Titas</td>
<td align="left">Age</td>
<td align="left">6.0</td>
</tr>
</tbody>
</table>
<p>So what is this package is doing. Looks trivial right? But we’ll look at some more complicated examples in following sections which perhaps may feel to you as non-trivial. So let’s continue.</p>
<p>Note that <code>read_cells</code> is neutral to file extension which means if somehow .xls file is saved as .csv file, then also it will detect the underlying file correctly as xls and use appreciate function to read tabular information contained in the file.</p>
<p>However, support for each file types apart from csv is based on optional R packages. If you simply type <code><a href="../reference/read_cells.html">read_cells()</a></code> in the console, it will print which file types are supported and which package is potentially required for functionality, those are currently not available. If any package is potentially required, install the same and restart the R session to make that effective.</p>
<p>Here is a sample output:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>()</a></code></pre></div>
<p><img src="ext/read_cells_out.png" width="550px"></p>
<p>Well, this is like <em>“I’m feeling lucky”</em> kind of thing as told you earlier. If the final result is not what you are looking for, you may have to do some bit of extra work.</p>
<p>The function <code>read_cells</code> has a few layers or stages of processing. You can choose the stage to stop processing and give intermediate results. Then you may manipulate the intermediate result, tune it and finally again resume processing (or do it outside <code>read_cells</code> completely!).</p>
<p>Notice that <code>read_cells</code> can be broken into pieces like</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">d1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>(fcsv, <span class="dt">at_level =</span> <span class="st">"va_classify"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>()</a>
<a class="sourceLine" id="cb7-3" title="3">d2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>(fcsv, <span class="dt">at_level =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="st">  </span><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>(<span class="dt">at_level =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="st">  </span><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>()</a>
<a class="sourceLine" id="cb7-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(d1, d2)</a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Now to make you understand what you can do with intermediate results, let’s explain to you other functionalities of the package and what are the steps followed by <code>read_cells</code>.</p>
<p>The flowchart of <code>read_cells</code> (<em>which will make more sense once you go through following section</em>)</p>
<p><img src="ext/read_cells.svg" width="356px" style="display: block; margin: auto;"></p>
</div>
<div id="making-data-tidy" class="section level3">
<h3 class="hasAnchor">
<a href="#making-data-tidy" class="anchor"></a>2. Making Data <em>tidy</em>
</h3>
<div id="as_cell_df" class="section level4">
<h4 class="hasAnchor">
<a href="#as_cell_df" class="anchor"></a>2.1 as_cell_df</h4>
<p>If you have any R object <code>x</code>, you can call <code>as_cell_df</code> convert it into a <code>cell-df</code> format (the format to store cell by cell information. See the documentation of <em>as_cell_df</em> or <em>cell_df-class</em> for more details).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">x &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() </a>
<a class="sourceLine" id="cb8-2" title="2">cd &lt;-<span class="st"> </span>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/as_cell_df.html">as_cell_df</a></span>(<span class="dt">take_col_names =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Each stored cell has an address specified by row and column and a value (converted to a string) and a possible data type. Thus the <code>cell_df</code> structure is defined. This is the first level of operations performed by <code>read_cells</code>.</p>
<p>You can even see how the data looks by issuing plot command.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(cd, <span class="dt">adaptive_txt_size =</span> <span class="ot">FALSE</span>, <span class="dt">txt_size =</span> <span class="fl">2.5</span>)</a></code></pre></div>
<p><img src="tidycells-intro_files/figure-html/unnamed-chunk-15-1.png" width="356px"></p>
</div>
<div id="value_attribute_classify" class="section level4">
<h4 class="hasAnchor">
<a href="#value_attribute_classify" class="anchor"></a>2.2 value_attribute_classify</h4>
<p>Next task is to assign each cell into <strong>value</strong>, <strong>attribute</strong> (of those values) and <strong>empty</strong> (irrelevant information). This is referred to in the package as value/attribute classification (VA classification). There are main 4 alternative ways to do this apart from manually editing by hand. These are documented in <code>value_attribute_classify</code> function.</p>
<p>For now, we’ll use the most useful classifier, <code>numeric_values_classifier</code>. It assumes the cells which can be converted to a number, as values and rest as attributes. If the cell is storing a number as a string (<em>remember the famous warning you may have seen in Excel about “Number Stored as Text”</em>) it will treat that as values.</p>
<p>Let’s take a sample example</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">dummy_dat &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/tibble/man/tibble.html">tibble</a></span>(<span class="dt">name =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Mr. X"</span>, <span class="st">"Mr. Y"</span>), <span class="dt">sal =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1,000"</span>,<span class="st">"12,000"</span>), <span class="dt">age =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">35</span>, <span class="dv">60</span>))</a>
<a class="sourceLine" id="cb10-2" title="2">dummy_dat</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">sal</th>
<th align="right">age</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mr. X</td>
<td align="left">1,000</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="left">Mr. Y</td>
<td align="left">12,000</td>
<td align="right">60</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">dummy_dat_cells &lt;-<span class="st"> </span>dummy_dat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/as_cell_df.html">as_cell_df</a></span>(<span class="dt">take_col_names =</span> <span class="ot">TRUE</span>) </a></code></pre></div>
<p>We can either do this</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">va_cells &lt;-<span class="st"> </span><span class="kw"><a href="../reference/numeric_values_classifier.html">numeric_values_classifier</a></span>(dummy_dat_cells)</a></code></pre></div>
<p>Or this</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">va_cells &lt;-<span class="st"> </span><span class="kw"><a href="../reference/value_attribute_classify.html">value_attribute_classify</a></span>(dummy_dat_cells, </a>
<a class="sourceLine" id="cb13-2" title="2">                                     <span class="dt">classifier =</span> <span class="kw"><a href="../reference/numeric_values_classifier.html">numeric_values_classifier</a></span>())</a></code></pre></div>
<p>Let’s plot it</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(va_cells, <span class="dt">adaptive_txt_size =</span> <span class="ot">FALSE</span>, <span class="dt">txt_size =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="tidycells-intro_files/figure-html/unnamed-chunk-21-1.png" width="256px"></p>
<p>Once VA classification is done, if you plot the cells you’ll notice the color scheme is now pointed at VA classification (which is given by <code>Type</code>) rather than cell types.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># let's resume with iris example</span></a>
<a class="sourceLine" id="cb15-2" title="2">cd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/numeric_values_classifier.html">numeric_values_classifier</a></span>(cd)</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(cd, <span class="dt">adaptive_txt_size =</span> <span class="ot">FALSE</span>, <span class="dt">txt_size =</span> <span class="fl">2.5</span>)</a></code></pre></div>
<p><img src="tidycells-intro_files/figure-html/unnamed-chunk-22-1.png" width="356px"></p>
</div>
<div id="analyze_cells" class="section level4">
<h4 class="hasAnchor">
<a href="#analyze_cells" class="anchor"></a>2.3 analyze_cells</h4>
<p>After this stage now the <code>cell-df</code> is ready for analysis (to understand data blocks, the orientation of attributes with respect to data or values). This is done via the following command.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">ca &lt;-<span class="st"> </span><span class="kw"><a href="../reference/analyze_cells.html">analyze_cells</a></span>(cd)</a></code></pre></div>
<p>This takes a while (the time taken is largely dependent on the complexity of the underlying tabular structure). Once it’s done you can plot the cell analysis and see how the heuristic detection has performed. Currently, only interactive way is developed for possible modifications in a cell analysis (covered in the subsequent section: <em>Interactive Modules</em>).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(ca)</a></code></pre></div>
<p><img src="tidycells-intro_files/figure-html/unnamed-chunk-25-1.png" width="356px"></p>
</div>
<div id="compose_cells" class="section level4">
<h4 class="hasAnchor">
<a href="#compose_cells" class="anchor"></a>2.4 compose_cells</h4>
<p>Having a cell analysis at hand, the next process to perform is to compose this cell analysis to form a composed columnar format data.frame. This is easily done as</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">dcomp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compose_cells.html">compose_cells</a></span>(ca)</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="co"># discarding other columns for printing (you can check them!)</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(dcomp[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>])</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">row</th>
<th align="right">col</th>
<th align="right">data_block</th>
<th align="left">value</th>
<th align="left">major_1</th>
<th align="left">major_2</th>
<th align="left">minor_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">5.1</td>
<td align="left">setosa</td>
<td align="left">Sepal.Length</td>
<td align="left">Species</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">4.9</td>
<td align="left">setosa</td>
<td align="left">Sepal.Length</td>
<td align="left">Species</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">4.7</td>
<td align="left">setosa</td>
<td align="left">Sepal.Length</td>
<td align="left">Species</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">4.6</td>
<td align="left">setosa</td>
<td align="left">Sepal.Length</td>
<td align="left">Species</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">5</td>
<td align="left">setosa</td>
<td align="left">Sepal.Length</td>
<td align="left">Species</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">5.4</td>
<td align="left">setosa</td>
<td align="left">Sepal.Length</td>
<td align="left">Species</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># let's check the same for va_cells (earlier dummy example)</span></a>
<a class="sourceLine" id="cb19-2" title="2">va_cells <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/analyze_cells.html">analyze_cells</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="st">  </span><span class="kw"><a href="../reference/compose_cells.html">compose_cells</a></span>(<span class="dt">discard_raw_cols =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">row</th>
<th align="right">col</th>
<th align="right">data_block</th>
<th align="left">value</th>
<th align="left">major_1</th>
<th align="left">major_2</th>
<th align="left">minor_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">1,000</td>
<td align="left">Mr. X</td>
<td align="left">sal</td>
<td align="left">name</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">12,000</td>
<td align="left">Mr. Y</td>
<td align="left">sal</td>
<td align="left">name</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="left">35</td>
<td align="left">Mr. X</td>
<td align="left">age</td>
<td align="left">name</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="left">60</td>
<td align="left">Mr. Y</td>
<td align="left">age</td>
<td align="left">name</td>
</tr>
</tbody>
</table>
<p>After this, you may like to see how the final data is connected or rendered from the actual table. To do this you may run</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw"><a href="../reference/cell_composition_traceback.html">cell_composition_traceback</a></span>(ca, <span class="dt">trace_row =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="tidycells-intro_files/figure-html/unnamed-chunk-30-1.png" width="288"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="../reference/cell_composition_traceback.html">cell_composition_traceback</a></span>(ca, <span class="dt">trace_row =</span> <span class="dv">10</span>)</a></code></pre></div>
<p><img src="tidycells-intro_files/figure-html/unnamed-chunk-30-2.png" width="288"></p>
<p>There is an optional interactive version of it, which is explained in the subsequent section <em>Interactive Modules</em>.</p>
</div>
<div id="collate_columns" class="section level4">
<h4 class="hasAnchor">
<a href="#collate_columns" class="anchor"></a>2.5 collate_columns</h4>
<p>The data should be consumable after the composition stage, in most of the cases. However, in the presence of extreme variations in the underlying data structure, another step may be required which can be coined as “collation of columns”. If somehow the data is a bit cooperative in a sense that from the data itself it can be inferred that which column should be mapped with which column, then this stage is useful. It is a stage which does approximate string matching (which is enhanced if you have optional dependency <a href="https://CRAN.R-project.org/package=stringdist"><code>stringdist</code></a> package) to find out inter-column mapping among various data blocks (if the data has multiple small tables). In case there is only one table (a single data block) then this stage will do almost nothing except renaming the columns. In <code>iris</code> and <code>dummy_dat</code> example, this is kind of meaningless. This will be clear to you once you move forward to the next section (<em>where <strong>“A more complicated example”</strong> is discussed</em>).</p>
<p>The function <code>collate_columns</code> is designed to carry out this operation. This can be easily done as</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">dcc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/collate_columns.html">collate_columns</a></span>(dcomp)</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(dcc)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">collated_1</th>
<th align="left">collated_2</th>
<th align="left">collated_3</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Sepal.Length</td>
<td align="left">setosa</td>
<td align="left">Species</td>
<td align="left">5.1</td>
</tr>
<tr class="even">
<td align="left">Sepal.Length</td>
<td align="left">setosa</td>
<td align="left">Species</td>
<td align="left">4.9</td>
</tr>
<tr class="odd">
<td align="left">Sepal.Length</td>
<td align="left">setosa</td>
<td align="left">Species</td>
<td align="left">4.7</td>
</tr>
<tr class="even">
<td align="left">Sepal.Length</td>
<td align="left">setosa</td>
<td align="left">Species</td>
<td align="left">4.6</td>
</tr>
<tr class="odd">
<td align="left">Sepal.Length</td>
<td align="left">setosa</td>
<td align="left">Species</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">Sepal.Length</td>
<td align="left">setosa</td>
<td align="left">Species</td>
<td align="left">5.4</td>
</tr>
</tbody>
</table>
<p>Note: You may omit this stage by choosing <code><a href="../reference/read_cells.html">read_cells(..., at_level = "compose")</a></code>.</p>
<p>That’s all. These are the process flow followed by <code>read_cells</code>. Thus, summing it all</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># below should match with </span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="co"># read_cells(fcsv) %&gt;% dplyr::select(-table_tag)</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="co"># * which (the column table_tag) is added to identify </span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="co"># * potential multiple tables.</span></a>
<a class="sourceLine" id="cb23-5" title="5">fcsv <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-7" title="7"><span class="st">  </span><span class="kw"><a href="../reference/as_cell_df.html">as_cell_df</a></span>(<span class="dt">take_col_names =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/numeric_values_classifier.html">numeric_values_classifier</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/analyze_cells.html">analyze_cells</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-10" title="10"><span class="st">  </span><span class="kw"><a href="../reference/compose_cells.html">compose_cells</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-11" title="11"><span class="st">  </span><span class="kw"><a href="../reference/collate_columns.html">collate_columns</a></span>()</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">collated_1</th>
<th align="left">collated_2</th>
<th align="left">collated_3</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Weight</td>
<td align="left">Nakshatra</td>
<td align="left">Kid.Name</td>
<td align="left">12</td>
</tr>
<tr class="even">
<td align="left">Weight</td>
<td align="left">Titas</td>
<td align="left">Kid.Name</td>
<td align="left">16</td>
</tr>
<tr class="odd">
<td align="left">Age</td>
<td align="left">Nakshatra</td>
<td align="left">Kid.Name</td>
<td align="left">1.5</td>
</tr>
<tr class="even">
<td align="left">Age</td>
<td align="left">Titas</td>
<td align="left">Kid.Name</td>
<td align="left">6</td>
</tr>
</tbody>
</table>
<p>A half-done item can be further manipulated and after the same, we can give it back to <code>read_cells</code> again to finish further processing (or simply can do it ourselves). Here is a sample manipulation example.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">rc_part &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>(fcsv, <span class="dt">at_level =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb24-2" title="2"><span class="co"># it is a list with `read_cells_stage` attribute</span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="co"># which indicate the last processed stage in read_cells</span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(rc_part)</a>
<a class="sourceLine" id="cb24-5" title="5"><span class="co">#&gt; List of 1</span></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="co">#&gt;  $ :Classes 'cell_df', 'cells', 'rc_df', 'tbl_df', 'tbl' and 'data.frame':   9 obs. of  4 variables:</span></a>
<a class="sourceLine" id="cb24-7" title="7"><span class="co">#&gt;   ..$ row      : int [1:9] 1 1 1 2 2 2 3 3 3</span></a>
<a class="sourceLine" id="cb24-8" title="8"><span class="co">#&gt;   ..$ col      : int [1:9] 1 2 3 1 2 3 1 2 3</span></a>
<a class="sourceLine" id="cb24-9" title="9"><span class="co">#&gt;   ..$ data_type: chr [1:9] "character" "character" "character" "character" ...</span></a>
<a class="sourceLine" id="cb24-10" title="10"><span class="co">#&gt;   ..$ value    : chr [1:9] "Kid Name" "Weight" "Age" "Nakshatra" ...</span></a>
<a class="sourceLine" id="cb24-11" title="11"><span class="co">#&gt;  - attr(*, "read_cells_stage")= chr "make_cells"</span></a>
<a class="sourceLine" id="cb24-12" title="12"><span class="co"># sample_based_classifier is another VA classifier</span></a>
<a class="sourceLine" id="cb24-13" title="13"><span class="co"># for details see coresponding documentation</span></a>
<a class="sourceLine" id="cb24-14" title="14">rc_part[[<span class="dv">1</span>]] &lt;-<span class="st"> </span>rc_part[[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-15" title="15"><span class="st">  </span><span class="kw"><a href="../reference/numeric_values_classifier.html">numeric_values_classifier</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-16" title="16"><span class="st">  </span><span class="kw"><a href="../reference/sample_based_classifier.html">sample_based_classifier</a></span>(<span class="dt">empty_sample =</span> <span class="st">"6"</span>)</a>
<a class="sourceLine" id="cb24-17" title="17">  </a>
<a class="sourceLine" id="cb24-18" title="18"></a>
<a class="sourceLine" id="cb24-19" title="19"><span class="co"># below should be similar to </span></a>
<a class="sourceLine" id="cb24-20" title="20"><span class="co"># rc_part[[1]] %&gt;% </span></a>
<a class="sourceLine" id="cb24-21" title="21"><span class="co">#   analyze_cells() %&gt;% </span></a>
<a class="sourceLine" id="cb24-22" title="22"><span class="co">#   compose_cells(discard_raw_cols = TRUE)</span></a>
<a class="sourceLine" id="cb24-23" title="23">rc_part <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>(<span class="dt">from_level =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb24-24" title="24"><span class="co">#&gt; # A tibble: 1 x 7</span></a>
<a class="sourceLine" id="cb24-25" title="25"><span class="co">#&gt;   collated_1 collated_2 collated_3 collated_4 collated_5 table_tag value</span></a>
<a class="sourceLine" id="cb24-26" title="26"><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb24-27" title="27"><span class="co">#&gt; 1 Weight     Nakshatra  Titas      Kid Name   Age        Table_1   12</span></a></code></pre></div>
<p><strong>A more complicated example</strong></p>
<p>Let’s take a quick look at another example data as given in</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"marks.xlsx"</span>, <span class="dt">package =</span> <span class="st">"tidycells"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>The data looks like (in excel)</p>
<p><img src="ext/marks.png" width="451px"></p>
<p>Let’s try our luck in this data</p>
<p>Read at once</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"marks.xlsx"</span>, <span class="dt">package =</span> <span class="st">"tidycells"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>()</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">collated_1</th>
<th align="left">collated_2</th>
<th align="left">collated_3</th>
<th align="left">collated_4</th>
<th align="left">collated_5</th>
<th align="left">table_tag</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Utsyo Roy</td>
<td align="left">Sheet1</td>
<td align="left">95</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Nakshatra Gayen</td>
<td align="left">Sheet1</td>
<td align="left">99</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Titas Gupta</td>
<td align="left">Sheet1</td>
<td align="left">89</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Ujjaini Gayen</td>
<td align="left">Sheet1</td>
<td align="left">100</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">Indranil Gayen</td>
<td align="left">Sheet1</td>
<td align="left">70</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">S Gayen</td>
<td align="left">Sheet1</td>
<td align="left">75</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">Sarmistha Senapati</td>
<td align="left">Sheet1</td>
<td align="left">81</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">Shtuti Roy</td>
<td align="left">Sheet1</td>
<td align="left">90</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School C</td>
<td align="left">Name</td>
<td align="left">I Roy</td>
<td align="left">Sheet1</td>
<td align="left">50</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School C</td>
<td align="left">Name</td>
<td align="left">S Ghosh</td>
<td align="left">Sheet1</td>
<td align="left">59</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School C</td>
<td align="left">Name</td>
<td align="left">S Senapati</td>
<td align="left">Sheet1</td>
<td align="left">61</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School C</td>
<td align="left">Name</td>
<td align="left">U Gupta</td>
<td align="left">Sheet1</td>
<td align="left">38</td>
</tr>
</tbody>
</table>
<p>Let’s understand step by step procedures followed by <code>read_cells</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># if you have tidyxl installed</span></a>
<a class="sourceLine" id="cb27-2" title="2">d &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"marks.xlsx"</span>, <span class="dt">package =</span> <span class="st">"tidycells"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/read_cells.html">read_cells</a></span>(<span class="dt">at_level =</span> <span class="st">"make_cells"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="st">  </span>.[[<span class="dv">1</span>]]</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># or you may do</span></a>
<a class="sourceLine" id="cb28-2" title="2">d &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"marks_cells.rds"</span>, <span class="dt">package =</span> <span class="st">"tidycells"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>()</a>
<a class="sourceLine" id="cb28-4" title="4">d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/numeric_values_classifier.html">numeric_values_classifier</a></span>(d)</a>
<a class="sourceLine" id="cb28-5" title="5">da &lt;-<span class="st"> </span><span class="kw"><a href="../reference/analyze_cells.html">analyze_cells</a></span>(d)</a></code></pre></div>
<p>Then you need to run <code>compose_cells</code> with additional new argument <code>print_attribute_overview = TRUE</code></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">dc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/compose_cells.html">compose_cells</a></span>(da, <span class="dt">print_attribute_overview =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="ext/compose_cells_cli1.png" width="451px"></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># bit tricky and tedious unless you do print_attribute_overview = TRUE in above line</span></a>
<a class="sourceLine" id="cb30-2" title="2">dcfine &lt;-<span class="st"> </span>dc <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">name =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(</a>
<a class="sourceLine" id="cb30-4" title="4">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span>major_row_left_<span class="dv">2</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb30-5" title="5">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>major_col_bottom_<span class="dv">1</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb30-6" title="6">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span>major_row_left_<span class="dv">1</span>_<span class="dv">1</span></a>
<a class="sourceLine" id="cb30-7" title="7">  ),</a>
<a class="sourceLine" id="cb30-8" title="8">  <span class="dt">sex =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(</a>
<a class="sourceLine" id="cb30-9" title="9">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span>major_row_left_<span class="dv">1</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb30-10" title="10">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>major_col_bottom_<span class="dv">2</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb30-11" title="11">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span>minor_row_right_<span class="dv">1</span>_<span class="dv">1</span></a>
<a class="sourceLine" id="cb30-12" title="12">  ),</a>
<a class="sourceLine" id="cb30-13" title="13">  <span class="dt">school =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(</a>
<a class="sourceLine" id="cb30-14" title="14">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span>minor_col_top_<span class="dv">1</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb30-15" title="15">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>minor_corner_topLeft_<span class="dv">1</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb30-16" title="16">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span>minor_col_top_<span class="dv">1</span>_<span class="dv">1</span></a>
<a class="sourceLine" id="cb30-17" title="17">  )) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-18" title="18"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(school,sex, name, value)</a></code></pre></div>
<p><code><a href="https://rdrr.io/r/utils/head.html">head(dcfine)</a></code> looks like</p>
<table class="table">
<thead><tr class="header">
<th align="left">school</th>
<th align="left">sex</th>
<th align="left">name</th>
<th align="center">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">School A</td>
<td align="left">Male</td>
<td align="left">Utsyo Roy</td>
<td align="center">95</td>
</tr>
<tr class="even">
<td align="left">School A</td>
<td align="left">Male</td>
<td align="left">Nakshatra Gayen</td>
<td align="center">99</td>
</tr>
<tr class="odd">
<td align="left">School A</td>
<td align="left">Female</td>
<td align="left">Titas Gupta</td>
<td align="center">89</td>
</tr>
<tr class="even">
<td align="left">School A</td>
<td align="left">Female</td>
<td align="left">Ujjaini Gayen</td>
<td align="center">100</td>
</tr>
<tr class="odd">
<td align="left">School B</td>
<td align="left">Male</td>
<td align="left">Indranil Gayen</td>
<td align="center">70</td>
</tr>
<tr class="even">
<td align="left">School B</td>
<td align="left">Male</td>
<td align="left">S Gayen</td>
<td align="center">75</td>
</tr>
</tbody>
</table>
<p>This is still not good right! You had to manually pick some weird column-names (when it was evident from data which columns should be aligned with whom).</p>
<p>The <code>collate_columns</code> functions does exactly this for you. So instead of manually picking column-names after compose cells you can simply run</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw"><a href="../reference/collate_columns.html">collate_columns</a></span>(dc) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">collated_1</th>
<th align="left">collated_2</th>
<th align="left">collated_3</th>
<th align="left">collated_4</th>
<th align="left">collated_5</th>
<th align="center">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Utsyo Roy</td>
<td align="center">95</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Nakshatra Gayen</td>
<td align="center">99</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Titas Gupta</td>
<td align="center">89</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Ujjaini Gayen</td>
<td align="center">100</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">Indranil Gayen</td>
<td align="center">70</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">S Gayen</td>
<td align="center">75</td>
</tr>
</tbody>
</table>
<p>Looks like staged example! Yes you are right, this is not always perfect (same is true for <code>analyze_cells</code> also). However, if the data is somehow helpful in demystifying underlying columns structure (like this one), then this will be useful.</p>
<p>Once again, these functions <code>read_cells</code> (all functionalities combined), <code>analyze_cells</code>, <code>collate_columns</code> are here to ease your pain in data wrangling and reading from various sources. It may not be full-proof solution to all types of tabular data. It is always recommended to perform these tasks manually whenever expected results are not coming.</p>
</div>
</div>
<div id="support-for-multiple-formats" class="section level3">
<h3 class="hasAnchor">
<a href="#support-for-multiple-formats" class="anchor"></a>3. Support for Multiple Formats</h3>
<p>When coming to support for multiple formats (assuming you have all the required packages as specified by <code>read_cells</code>) you can run following set of command to test the multi-format support in <code>read_cells</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">dm &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/tibble/man/tibble.html">tibble</a></span>(<span class="dt">fn =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(fold, <span class="dt">full.names =</span> T))</a>
<a class="sourceLine" id="cb32-2" title="2">dm<span class="op">$</span>fn <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/basename.html">basename</a></span>()</a>
<a class="sourceLine" id="cb32-3" title="3"><span class="co">#&gt; [1] "csv.docx"  "docx.html" "html.csv"  "pdf.docx"  "xls.pdf"   "xlsx.csv"</span></a></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">dcomps &lt;-<span class="st"> </span>dm<span class="op">$</span>fn <span class="op">%&gt;%</span><span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/purrr/man/map.html">map</a></span>(read_cells)</a>
<a class="sourceLine" id="cb33-2" title="2">dcomps_sel &lt;-<span class="st"> </span>dcomps <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="st">    </span>purrr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/purrr/man/map.html">map</a></span>(<span class="op">~</span><span class="st"> </span>.x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="st">      </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(value, collated_<span class="dv">1</span>, collated_<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb33-5" title="5"><span class="co"># all of them are same [intentionaly made. but the file types are totally different]</span></a>
<a class="sourceLine" id="cb33-6" title="6">dcomps_sel <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="st">  </span>purrr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_lgl</a></span>(<span class="op">~</span><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(.x, dcomps_sel[[<span class="dv">1</span>]])) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-8" title="8"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/all.html">all</a></span>()</a>
<a class="sourceLine" id="cb33-9" title="9"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb33-10" title="10"><span class="co"># check one sample</span></a>
<a class="sourceLine" id="cb33-11" title="11">dcomps_sel[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb33-12" title="12"><span class="co">#&gt; # A tibble: 4 x 3</span></a>
<a class="sourceLine" id="cb33-13" title="13"><span class="co">#&gt;   value collated_1 collated_2</span></a>
<a class="sourceLine" id="cb33-14" title="14"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;     </span></a>
<a class="sourceLine" id="cb33-15" title="15"><span class="co">#&gt; 1 12    Weight     Nakshatra </span></a>
<a class="sourceLine" id="cb33-16" title="16"><span class="co">#&gt; 2 16    Weight     Titas     </span></a>
<a class="sourceLine" id="cb33-17" title="17"><span class="co">#&gt; 3 1.5   Age        Nakshatra </span></a>
<a class="sourceLine" id="cb33-18" title="18"><span class="co">#&gt; 4 6     Age        Titas</span></a></code></pre></div>
<p>Each file is with the wrong extension and the original extension should be the file name part before extension (intentionally created for testing this feature). Like for example, docx.csv is actually a docx. You can copy into some location where you have write access, then rename appropriately and open it to verify.</p>
</div>
<div id="interactive-modules" class="section level3">
<h3 class="hasAnchor">
<a href="#interactive-modules" class="anchor"></a>4. Interactive Modules</h3>
<p>The package also provides shiny based interactive visualisations for understanding how the heuristic is functioning and also provides object (like <code>cell-df</code> or <code>cell-analysis</code>) editing capabilities.</p>
<p>The <a href="https://shiny.rstudio.com/">shiny</a> package is required for these functions. Most of the features are self-explanatory and guided. Check out interactive documentation of any of these functions listed below. All of these functions are available as <a href="https://rstudio.github.io/rstudioaddins/">RStudio Addins</a>. Here are screenshots of each interactive widgets.</p>
<ol style="list-style-type: decimal">
<li>Plot tune (part of all modules)</li>
<li>
<code><a href="../reference/visual_functions.html">visual_crop()</a></code> for data crop and deletion of sections</li>
</ol>
<p><img src="ext/v12.png" width="516px"></p>
<ol start="3" style="list-style-type: decimal">
<li>
<code><a href="../reference/visual_functions.html">visual_va_classify()</a></code> for interactive VA classification</li>
<li>
<code><a href="../reference/visual_functions.html">visual_data_block_inspection()</a></code> this shows how the heuristic has performed the analysis after <code>analyze_cells</code>
</li>
</ol>
<p><img src="ext/v34.png" width="516px"></p>
<ol start="5" style="list-style-type: decimal">
<li>
<code><a href="../reference/visual_functions.html">visual_orientation_modification()</a></code> for modification to heuristic based results</li>
<li>
<code><a href="../reference/visual_functions.html">visual_traceback()</a></code> this is for observing how the original data is composed to form the final output. (<code>compose_cells</code> is called internally)</li>
</ol>
<p><img src="ext/v56.png" width="516px"></p>
<p>For each of these modules, there is a dynamic plot option available from <a href="https://github.com/ropensci/plotly">plotly</a>. If you have that package the corresponding tab will be activated. Since all of these modules are entirely optional the dependency is kept at <strong>tidycells</strong> ‘suggests’ level only.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#tidycells"><strong>tidycells</strong></a><ul class="nav nav-pills nav-stacked">
<li><a href="#tldr">TL;DR</a></li>
      <li><a href="#inspiration">Inspiration</a></li>
      <li><a href="#introduction">Introduction</a></li>
      <li><a href="#getting-started">Getting Started</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Indranil Gayen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
