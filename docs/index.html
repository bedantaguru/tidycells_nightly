<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Read Tabular Data from Diverse Sources and Easily Make
    Them Tidy • tidycells</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Read Tabular Data from Diverse Sources and Easily Make
    Them Tidy">
<meta property="og:description" content="Provides utilities to read, cells from complex
    tabular data and heuristic detection based structural assignment of
    those cells to a columnar or tidy format. Read functionality has the
    ability to read structured, partially structured or unstructured
    tabular data from various types of documents. The structural
    assignment functionality has both supervised and unsupervised way of
    assigning cells data to columnar/tidy format. Multiple disconnected
    blocks of tables in a single sheet are also handled appropriately.
    These tools are suitable for unattended conversation of messy tables
    into a consumable format(usable for further analysis and data
    wrangling).">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">tidycells</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/tidycells-intro.html">Tidycells Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-rudra/tidycells">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="tidycells-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#tidycells-" class="anchor"></a><strong>tidycells</strong> <img src="articles/ext/logo.svg" align="right" width="200">
</h1></div>
<div id="read-tabular-data-from-diverse-sources-and-easily-make-them-tidy" class="section level4">
<h4 class="hasAnchor">
<a href="#read-tabular-data-from-diverse-sources-and-easily-make-them-tidy" class="anchor"></a><em>Read Tabular Data from Diverse Sources and Easily Make Them Tidy</em>
</h4>
<!-- badges: start -->

<!-- badges: end -->
</div>
<div id="author" class="section level2">
<h2 class="hasAnchor">
<a href="#author" class="anchor"></a>Author</h2>
<p><a href="https://orcid.org/0000-0003-0197-1944">Indranil Gayen</a></p>
</div>
<div id="tldr" class="section level2">
<h2 class="hasAnchor">
<a href="#tldr" class="anchor"></a>TL;DR</h2>
<p>Given a <code>file_name</code> which is a path of a file that contains table(s). Run this <code><a href="reference/read_cells.html">read_cells()</a></code> in the R-console to see whether support is present for the file type. If support is present, just run</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="reference/read_cells.html">read_cells</a></span>(file_name)</a></code></pre></div>
<p><strong>Note</strong></p>
<ul>
<li>Just start with a small file, as heuristic-algorithm are not well-optimized (yet).</li>
<li>If the target table has numerical values as data and text as their attribute (identifier of the data elements), straight forward method is sufficient in the majority of situations. Otherwise, you may need to utilize other functions.</li>
</ul>
<p><strong>A Word of Warning</strong> :</p>
<p><em>Many functions in this package are heuristic-algorithm based. Thus, outcomes may be unexpected. I recommend you to try <code>read_cells</code> on the target file. If the outcome is what you are expecting, it is fine. If not try again with <code><a href="reference/read_cells.html">read_cells(file_name, at_level = "compose")</a></code>. If after that also the output is not as expected then other functions are required to be used. At that time start again with <code><a href="reference/read_cells.html">read_cells(file_name, at_level = "make_cells")</a></code> and proceed to further functions.</em></p>
</div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The package provides utilities to read, cells from complex tabular data and heuristic detection based ‘structural assignment’ of those cells to a columnar or tidy format.</p>
<p>Read functionality has the ability to read (in a unified manner) structured, partially structured or unstructured tabular data (usually spreadsheets for public data dissemination and aimed for common human understanding) from various types of documents. The tabular information is read as cells. The ‘structure assignment’ functionality has both supervised and unsupervised way of assigning cells data to columnar/tidy format. Multiple disconnected blocks of tables in a single sheet are also handled appropriately.</p>
<p>These tools are suitable for unattended conversation of (maybe a pile of) messy tables (like government data) into a consumable format(usable for further analysis and data wrangling).</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the <a href="https://CRAN.R-project.org/package=tidycells">CRAN</a> version:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"tidycells"</span>)</a></code></pre></div>
<p>To install the development version from GitHub you’ll need <code>remotes</code> package in R (comes with <code>devtools</code>). Assuming you have <code>remotes</code> you can install this package in R with the following command:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># devtools::install_github is actually remotes::install_github</span></a>
<a class="sourceLine" id="cb3-2" title="2">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"r-rudra/tidycells"</span>)</a></code></pre></div>
<p>To start with <code>tidycells</code>, I invite you to see <code><a href="articles/tidycells-intro.html">vignette("tidycells-intro")</a></code> or check out <a href="https://r-rudra.github.io/tidycells/">tidycells-website</a> (<em>to see vignette you need to install the package with vignette. That can be done in above command (<code><a href="https://rdrr.io/pkg/remotes/man/install_github.html">remotes::install_github</a></code>) by specifying <code>build_vignettes = TRUE</code>. Note that, it might be time consuming. CRAN version comes with prebuilt-vignette</em>).</p>
</div>
<div id="quick-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-overview" class="anchor"></a>Quick Overview</h2>
<p>Let’s take a quick look at an example data as given in</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">filename &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"marks.xlsx"</span>, <span class="dt">package =</span> <span class="st">"tidycells"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>The data looks like (in excel)</p>
<p><img src="articles/ext/marks.png" width="451px"></p>
<p>Let’s try <code>tidycells</code> functions in this data</p>
<p>Read at once</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># you should have tidyxl installed</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw"><a href="reference/read_cells.html">read_cells</a></span>(filename)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">collated_1</th>
<th align="left">collated_2</th>
<th align="left">collated_3</th>
<th align="left">collated_4</th>
<th align="left">collated_5</th>
<th align="left">table_tag</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Utsyo Roy</td>
<td align="left">Sheet1</td>
<td align="left">95</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Nakshatra Gayen</td>
<td align="left">Sheet1</td>
<td align="left">99</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Titas Gupta</td>
<td align="left">Sheet1</td>
<td align="left">89</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Ujjaini Gayen</td>
<td align="left">Sheet1</td>
<td align="left">100</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">Indranil Gayen</td>
<td align="left">Sheet1</td>
<td align="left">70</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">S Gayen</td>
<td align="left">Sheet1</td>
<td align="left">75</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">Sarmistha Senapati</td>
<td align="left">Sheet1</td>
<td align="left">81</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">Shtuti Roy</td>
<td align="left">Sheet1</td>
<td align="left">90</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School C</td>
<td align="left">Name</td>
<td align="left">I Roy</td>
<td align="left">Sheet1</td>
<td align="left">50</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School C</td>
<td align="left">Name</td>
<td align="left">S Ghosh</td>
<td align="left">Sheet1</td>
<td align="left">59</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School C</td>
<td align="left">Name</td>
<td align="left">S Senapati</td>
<td align="left">Sheet1</td>
<td align="left">61</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School C</td>
<td align="left">Name</td>
<td align="left">U Gupta</td>
<td align="left">Sheet1</td>
<td align="left">38</td>
</tr>
</tbody>
</table>
<p>The function <code>read_cells</code> is a set of ordered operations connected together. The flowchart of <code>read_cells</code>:</p>
<p><img src="articles/ext/read_cells.svg" width="356px" style="display: block; margin: auto;"></p>
<p>Let’s understand step by step procedures followed by <code>read_cells</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># if you have tidyxl installed</span></a>
<a class="sourceLine" id="cb6-2" title="2">d &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"marks.xlsx"</span>, <span class="dt">package =</span> <span class="st">"tidycells"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">  </span><span class="kw"><a href="reference/read_cells.html">read_cells</a></span>(<span class="dt">at_level =</span> <span class="st">"make_cells"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="st">  </span>.[[<span class="dv">1</span>]]</a></code></pre></div>
<p>Or</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># or you may do</span></a>
<a class="sourceLine" id="cb7-2" title="2">d &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"marks_cells.rds"</span>, <span class="dt">package =</span> <span class="st">"tidycells"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>()</a></code></pre></div>
<p>Then</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">d &lt;-<span class="st"> </span><span class="kw"><a href="reference/numeric_values_classifier.html">numeric_values_classifier</a></span>(d)</a>
<a class="sourceLine" id="cb8-2" title="2">da &lt;-<span class="st"> </span><span class="kw"><a href="reference/analyze_cells.html">analyze_cells</a></span>(d)</a></code></pre></div>
<p>After this you need to run <code>compose_cells</code> (with argument <code>print_attribute_overview = TRUE</code>)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">dc &lt;-<span class="st"> </span><span class="kw"><a href="reference/compose_cells.html">compose_cells</a></span>(da, <span class="dt">print_attribute_overview =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="articles/ext/compose_cells_cli1.png" width="451px"></p>
<p>If you want a well-aligned columns then you may like to do</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># bit tricky and tedious unless you do print_attribute_overview = TRUE in above line</span></a>
<a class="sourceLine" id="cb10-2" title="2">dcfine &lt;-<span class="st"> </span>dc <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span>(<span class="dt">name =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/case_when.html">case_when</a></span>(</a>
<a class="sourceLine" id="cb10-4" title="4">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span>major_row_left_<span class="dv">2</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-5" title="5">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>major_col_bottom_<span class="dv">1</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-6" title="6">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span>major_row_left_<span class="dv">1</span>_<span class="dv">1</span></a>
<a class="sourceLine" id="cb10-7" title="7">  ),</a>
<a class="sourceLine" id="cb10-8" title="8">  <span class="dt">sex =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/case_when.html">case_when</a></span>(</a>
<a class="sourceLine" id="cb10-9" title="9">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span>major_row_left_<span class="dv">1</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-10" title="10">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>major_col_bottom_<span class="dv">2</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-11" title="11">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span>minor_row_right_<span class="dv">1</span>_<span class="dv">1</span></a>
<a class="sourceLine" id="cb10-12" title="12">  ),</a>
<a class="sourceLine" id="cb10-13" title="13">  <span class="dt">school =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/case_when.html">case_when</a></span>(</a>
<a class="sourceLine" id="cb10-14" title="14">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span>minor_col_top_<span class="dv">1</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-15" title="15">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>minor_corner_topLeft_<span class="dv">1</span>_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-16" title="16">    data_block <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span>minor_col_top_<span class="dv">1</span>_<span class="dv">1</span></a>
<a class="sourceLine" id="cb10-17" title="17">  )) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span>(school,sex, name, value)</a></code></pre></div>
<p><code><a href="https://rdrr.io/r/utils/head.html">head(dcfine)</a></code> looks like</p>
<table class="table">
<thead><tr class="header">
<th align="left">school</th>
<th align="left">sex</th>
<th align="left">name</th>
<th align="center">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">School A</td>
<td align="left">Male</td>
<td align="left">Utsyo Roy</td>
<td align="center">95</td>
</tr>
<tr class="even">
<td align="left">School A</td>
<td align="left">Male</td>
<td align="left">Nakshatra Gayen</td>
<td align="center">99</td>
</tr>
<tr class="odd">
<td align="left">School A</td>
<td align="left">Female</td>
<td align="left">Titas Gupta</td>
<td align="center">89</td>
</tr>
<tr class="even">
<td align="left">School A</td>
<td align="left">Female</td>
<td align="left">Ujjaini Gayen</td>
<td align="center">100</td>
</tr>
<tr class="odd">
<td align="left">School B</td>
<td align="left">Male</td>
<td align="left">Indranil Gayen</td>
<td align="center">70</td>
</tr>
<tr class="even">
<td align="left">School B</td>
<td align="left">Male</td>
<td align="left">S Gayen</td>
<td align="center">75</td>
</tr>
</tbody>
</table>
<p>This is still not good right! You had to manually pick some weird column-names and spent some time and energy (when it was evident from data which columns should be aligned with whom).</p>
<p>The <code>collate_columns</code> functions does exactly this for you. So instead of manually picking column-names after <em>compose cells</em> you can simply run</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># collate_columns(dc) should be same with </span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co"># direct read_cells() result except table_tag column</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw"><a href="reference/collate_columns.html">collate_columns</a></span>(dc) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">collated_1</th>
<th align="left">collated_2</th>
<th align="left">collated_3</th>
<th align="left">collated_4</th>
<th align="left">collated_5</th>
<th align="center">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Utsyo Roy</td>
<td align="center">95</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Nakshatra Gayen</td>
<td align="center">99</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Titas Gupta</td>
<td align="center">89</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Female</td>
<td align="left">School A</td>
<td align="left">Student Name</td>
<td align="left">Ujjaini Gayen</td>
<td align="center">100</td>
</tr>
<tr class="odd">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">Indranil Gayen</td>
<td align="center">70</td>
</tr>
<tr class="even">
<td align="left">Score</td>
<td align="left">Male</td>
<td align="left">School B</td>
<td align="left">Student</td>
<td align="left">S Gayen</td>
<td align="center">75</td>
</tr>
</tbody>
</table>
<p>Looks like staged example! Yes, you are right this is not always perfect (same is true for <code>analyze_cells</code> also). However, if the data is somehow helpful in demystifying underlying columns structure (like this one), then this will be useful.</p>
<p>These functions <code>read_cells</code> (all functionalities combined), <code>analyze_cells</code>, <code>collate_columns</code> are here to ease your pain in data wrangling and reading from various sources. It may not be full-proof solution to all types of tabular data. It is always recommended to perform these tasks manually whenever expected results are not coming.</p>
<div id="plots-and-interactive-modules" class="section level3">
<h3 class="hasAnchor">
<a href="#plots-and-interactive-modules" class="anchor"></a>Plots and Interactive Modules</h3>
<p>The package provides <code>ggplot</code> based plots and <code>shiny</code> based interactive visualisations for understanding how the heuristic is functioning and also provides object (like <code>cell-df</code> or <code>cell-analysis</code>) editing capabilities.</p>
<p>The <a href="https://shiny.rstudio.com/">shiny</a> package is required for interactive modules. Most of the features are self-explanatory and guided.</p>
<p>Check out interactive documentation of any of these functions listed below. All of these functions are available as <a href="https://rstudio.github.io/rstudioaddins/">RStudio Addins</a>.</p>
<p>Here are screenshots of each interactive widgets.</p>
<ol>
<li>Plot tune (part of all modules)</li>
<li>
<code><a href="reference/visual_functions.html">visual_crop()</a></code> for data crop and deletion of sections</li>
</ol>
<p><img src="articles/ext/v12.png" width="516px"></p>
<ol>
<li>
<code><a href="reference/visual_functions.html">visual_va_classify()</a></code> for interactive VA classification</li>
<li>
<code><a href="reference/visual_functions.html">visual_data_block_inspection()</a></code> this shows how the heuristic has performed the analysis after <code>analyze_cells</code>
</li>
</ol>
<p><img src="articles/ext/v34.png" width="516px"></p>
<ol>
<li>
<code><a href="reference/visual_functions.html">visual_orientation_modification()</a></code> for modification to heuristic based results</li>
<li>
<code><a href="reference/visual_functions.html">visual_traceback()</a></code> this is for observing how the original data is composed to form the final output. (<code>compose_cells</code> is called internally)</li>
</ol>
<p><img src="articles/ext/v56.png" width="516px"></p>
<p>For each of these modules, there is a dynamic plot option available from <a href="https://github.com/ropensci/plotly">plotly</a>. If you have that package, the corresponding tab will be activated. Since all of these modules are entirely optional the dependency is kept at <strong>tidycells</strong> ‘suggests’ level only.</p>
</div>
</div>
<div id="reference-and-related-projects" class="section level2">
<h2 class="hasAnchor">
<a href="#reference-and-related-projects" class="anchor"></a>Reference and Related Projects</h2>
<ul>
<li>
<a href="https://github.com/nacnudus/tidyxl">tidyxl</a>: <strong>Read Untidy Excel Files:</strong> Imports non-tabular from Excel files into R. Exposes cell content, position and formatting in a tidy structure for further manipulation. Tokenizes Excel formulas. Supports ‘.xlsx’ and ‘.xlsm’ via the embedded ‘RapidXML’ C++ library <a href="http://rapidxml.sourceforge.net" class="uri">http://rapidxml.sourceforge.net</a>. Does not support ‘.xlsb’ or ‘.xls’.</li>
<li>
<a href="https://github.com/nacnudus/unpivotr">unpivotr</a>: <strong>Unpivot Complex and Irregular Data Layouts</strong> Tools for converting data from complex or irregular layouts to a columnar structure. For example, tables with multilevel column or row headers, or spreadsheets. Header and data cells are selected by their contents and position, as well as formatting and comments where available, and are associated with one other by their proximity in given directions. Functions for data frames and HTML tables are provided. Major parts of the package right now fully depend on <strong>unpivotr</strong>. The <strong>tidycells</strong> package would have never existed without this wonderful package from <a href="https://github.com/nacnudus">Duncan Garmonsway</a>.</li>
<li>The <a href="https://github.com/rsheets">rsheets</a> project: It hosts several R packages (few of them are in CRAN already) which are in the early stages of importing spreadsheets from Excel and Google Sheets into R. Specifically, have a look at these projects which seems closely related to these projects : <a href="https://github.com/rsheets/jailbreakr">jailbreaker</a>, <a href="https://github.com/rsheets/rexcel">rexcel</a> (README of this project has a wonderful reference for excel integration with R).</li>
<li>
<a href="https://github.com/MattCowgill/readabs">readabs</a>: <strong>Download and Tidy Time Series Data from the Australian Bureau of Statistics</strong> The <code>readabs</code> package helps you easily download, import, and tidy time series data from the <a href="https://www.abs.gov.au/">Australian Bureau of Statistics</a> from within R. This saves you time manually downloading and tediously tidying time series data and allows you to spend more time on your analysis.</li>
<li>
<a href="https://CRAN.R-project.org/package=ezpickr">ezpickr</a>: <strong>Easy Data Import Using GUI File Picker and Seamless Communication Between an Excel and R</strong> Gives ability for choosing any rectangular data file using interactive GUI dialog box, and seamlessly manipulating tidy data between an ‘Excel’ window and R session.</li>
<li>The <a href="https://github.com/ianmoran11/tidyABS">tidyABS</a> package: The <code>tidyABS</code> package converts ABS excel tables to tidy data frames. It uses rules-of-thumb to determine the structure of excel tables, however it sometimes requires pointers from the user. This package is in early development.</li>
<li>The <a href="https://github.com/tdoehmen/hypoparsr">hypoparsr</a> package: This package takes a different approach to CSV parsing by creating different parsing hypotheses for a given file and ranking them based on data quality features.</li>
</ul>
</div>
<div id="acknowledgement" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgement" class="anchor"></a>Acknowledgement</h2>
<p>This package incomplete without following packages (apart from the <strong>unpivotr</strong> which is the core package on which <strong>tidycells</strong> depends largely, as mentioned above). Each of these packages are in suggests fields of <code>tidycells</code>. (The read_cells basically, performs unification on several functions from various packages to give you support for different file types. These are listed below.)</p>
<ul>
<li>
<a href="https://cran.r-project.org/package=readr"><strong>readr</strong></a>: for csv (in melted format)</li>
<li>
<a href="https://cran.r-project.org/package=readxl"><strong>readxl</strong></a>: for reading xls (if xlsx is present by default xlsx will be used for xls)</li>
<li>
<a href="https://cran.r-project.org/package=xlsx"><strong>xlsx</strong></a>: for reading xls (also it has capabilities to read xlsx)</li>
<li>
<a href="https://cran.r-project.org/package=tidyxl"><strong>tidyxl</strong></a>: really fast library for reading xlsx</li>
<li>
<a href="https://cran.r-project.org/package=docxtractr"><strong>docxtractr</strong></a> : for docx and doc (it has a system level dependency now)</li>
<li>
<a href="https://cran.r-project.org/package=tabulizer"><strong>tabulizer</strong></a> : for pdf</li>
<li>
<a href="https://cran.r-project.org/package=XML"><strong>XML</strong></a> : for html/xml type files</li>
<li>
<a href="https://CRAN.R-project.org/package=stringdist"><strong>stringdist</strong></a> : for enhanced string matching in <code><a href="reference/collate_columns.html">tidycells::collate_columns</a></code>
</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=tidycells">https://​cloud.r-project.org/​package=tidycells</a>
</li>
<li>Browse source code at <br><a href="https://github.com/r-rudra/tidycells">https://​github.com/​r-rudra/​tidycells</a>
</li>
<li>Report a bug at <br><a href="https://github.com/r-rudra/tidycells/issues">https://​github.com/​r-rudra/​tidycells/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Indranil Gayen <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-0197-1944" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=tidycells"><img src="https://www.r-pkg.org/badges/version/tidycells" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/web/checks/check_results_tidycells.html"><img src="https://cranchecks.info/badges/summary/tidycells" alt="CRAN checks"></a></li>
<li><a href="https://travis-ci.org/r-rudra/tidycells"><img src="https://travis-ci.org/r-rudra/tidycells.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://ci.appveyor.com/project/bedantaguru/tidycells"><img src="https://ci.appveyor.com/api/projects/status/github/r-rudra/tidycells?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
<li><a href="https://github.com/r-rudra/tidycells/blob/master/dev-notes.md#all-r-hub-build-summary"><img src="https://img.shields.io/badge/R_Hub-11/20_OK-green?style=flat-square&amp;logo=R" alt="R-hub checks"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://codecov.io/gh/r-rudra/tidycells?branch=master"><img src="https://codecov.io/gh/r-rudra/tidycells/branch/master/graph/badge.svg" alt="Codecov Coverage Status"></a></li>
<li><a href="https://coveralls.io/github/r-rudra/tidycells?branch=master"><img src="https://coveralls.io/repos/github/r-rudra/tidycells/badge.svg?branch=master&amp;service=github" alt="Coveralls Coverage Status"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg?style=flat-square" alt="Lifecycle"></a></li>
<li><a href="https://CRAN.R-project.org/package=tidycells"><img src="https://img.shields.io/badge/Depends-9/28-orange.svg?style=flat-square" alt="Dependency status"></a></li>
<li><a href="https://raw.githubusercontent.com/r-rudra/tidycells/master/LICENSE.md"><img src="https://img.shields.io/github/license/mashape/apistatus.svg" alt="license"></a></li>
<li><a href="https://github.com/r-rudra/tidycells/blob/master/dev-notes.md"><img src="https://img.shields.io/badge/See-DevNotes-blue.svg?style=flat-square" alt="See DevNotes"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Indranil Gayen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
